---
title: 方塊快速下落
description: 方塊快速下落 - Instant Falling(IF)
toc: false
---

## 方塊快速下落(Instant Falling - IF)

minecraft 為了在區塊裝飾時預先處理沙子等下落方塊，故添加了本規則。(_**後續文章可能會使用 `IF` 來代指它 \[瞬時下落 Instant Falling]**_)

```java{2} [BlockFalling.java] line-numbers
public class BlockFalling extends Block {
  public static boolean fallInstantly; // [!code focus]

  // ...
}
```

## 在哪被修改

會在在區塊裝飾時短暫開啟該 flag，並在結束後關閉。

> 小知識下面的 `code` 上面有比較完整的~~

```java{2,4} [ChunkGeneratorOverworld.java] line-numbers
public void populate(int x, int z) {
  BlockFalling.fallInstantly = true; // [!code focus]
  // 一些裝飾邏輯
  BlockFalling.fallInstantly = false; // [!code focus]
}
```

## 如何開啟

在區塊生成(裝飾)時，會開啟 `ITT`，並放置水、岩漿等方塊。
由於 ITT 開啟，這些方塊會立刻流動完畢。若此時產生更新抑制，後續程式（包含關閉 `ITT`）會被跳過，導致 ITT 未被關閉。

## 如何關閉

1. 重啟服務器
2. 重新加載之前未被加載過的區塊 (裝飾)

## 開啟時影響

### 偵測器

開啟後偵測器檢測偵測器時，不管是亮還是滅都會被下一個偵測器檢測到，造成**指數級更新**。請注意不要在主線程放置會導致主線程卡死並觸發 WatchDog 超時崩潰。

### 注意事項

1. 不可再主進程放置臉對臉或長偵測器鏈等會造成指數級更新的方塊，這會導致主線程卡死
2. 不可放置及更新:

::div{class="ml-4"}
- 冰霜
- 絆線鉤
- 壓力板 ~~< 請特別注意他，由其是神奇村莊 !!! 會有一堆神奇壓力板桌子，村民會碰到 :smart-icon{name="😭"}~~
- 感測鐵軌
- 減法比較器高頻
::
